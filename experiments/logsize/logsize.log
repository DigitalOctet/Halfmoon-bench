Finish setup in 72.890 seconds
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_read
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.1
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Nothing found in stack: boki
+ sleep 40
++ tr -dc a-zA-Z0-9
++ fold -w 8
++ head -n 1
++ head -c 64 /dev/urandom
+ TABLE_PREFIX=nHLJkNik
+ TABLE_PREFIX=nHLJkNik-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
fb0b3276a519: Pulling fs layer
04650d0140a3: Pulling fs layer
2bde0ecdcf0b: Pulling fs layer
631d66a347c9: Pulling fs layer
e3176dba68e3: Pulling fs layer
2c4530d68e03: Pulling fs layer
631d66a347c9: Waiting
e3176dba68e3: Waiting
2c4530d68e03: Waiting
fb0b3276a519: Verifying Checksum
fb0b3276a519: Download complete
2bde0ecdcf0b: Verifying Checksum
2bde0ecdcf0b: Download complete
04650d0140a3: Verifying Checksum
04650d0140a3: Download complete
fb0b3276a519: Pull complete
2c4530d68e03: Verifying Checksum
2c4530d68e03: Download complete
631d66a347c9: Verifying Checksum
631d66a347c9: Download complete
e3176dba68e3: Verifying Checksum
e3176dba68e3: Download complete
04650d0140a3: Pull complete
2bde0ecdcf0b: Pull complete
631d66a347c9: Pull complete
e3176dba68e3: Pull complete
2c4530d68e03: Pull complete
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Downloaded newer image for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=nHLJkNik- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 16:50:34 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=nHLJkNik- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 16:50:40 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=nHLJkNik- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.1 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-gateway
Creating service boki_boki-storage
Creating service boki_rw-service
Creating service boki_zookeeper-setup
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-sequencer
Creating service boki_prewarm-service
Creating service boki_zookeeper
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f15db0ab58a3481b3366ad47a808416e3a7062610b5ff502557186e81e86cf1e
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f15db0ab58a3481b3366ad47a808416e3a7062610b5ff502557186e81e86cf1e/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=60dcdd35627df90608f007cd785af59678e4c6bec0a8429f4ef71dc7533b956b
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/60dcdd35627df90608f007cd785af59678e4c6bec0a8429f4ef71dc7533b956b/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=4be16a32cf5932cccfba9e490e2e244187d9c2dbb788abad5c165f8fa34c63cd
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/4be16a32cf5932cccfba9e490e2e244187d9c2dbb788abad5c165f8fa34c63cd/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6d117b442caa4dc180480dbd11cd9e32f2d8598d83ef2a552d20603c47cad292
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6d117b442caa4dc180480dbd11cd9e32f2d8598d83ef2a552d20603c47cad292/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d7ccb1d185c90581dafcdfc6a2a6f7c5dc2ecf81a46a47e969d41fc1fc50034d
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d7ccb1d185c90581dafcdfc6a2a6f7c5dc2ecf81a46a47e969d41fc1fc50034d/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0a056e7dcacab96ea3a7d6e38bda3bf3b8bd3028de071bc05f8fa3148d00cc88
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0a056e7dcacab96ea3a7d6e38bda3bf3b8bd3028de071bc05f8fa3148d00cc88/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f9c9bcbf9004140ebe4768b5f34018fed0b648548643d07085b85636969bb65b
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f9c9bcbf9004140ebe4768b5f34018fed0b648548643d07085b85636969bb65b/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d05d87e4e573a7d12b89549cab79e5f6faca32147026d80127f6a960b8463d35
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d05d87e4e573a7d12b89549cab79e5f6faca32147026d80127f6a960b8463d35/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=nHLJkNik- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 17:06:27 [INFO] log mode: READLOG
finished ReadRatio0.1_QPS100_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_write
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.1
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ fold -w 8
++ head -n 1
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
+ TABLE_PREFIX=AqlcEyZ2
+ TABLE_PREFIX=AqlcEyZ2-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=AqlcEyZ2- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 17:08:16 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=AqlcEyZ2- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 17:08:23 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=AqlcEyZ2- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.1 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=040ac8a090dfe389585f230fb127825d36635abb9a9aa87bf33662a246b08b19
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/040ac8a090dfe389585f230fb127825d36635abb9a9aa87bf33662a246b08b19/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=fa9ebfe2ca829f8a8fdabb93a58a1b776da589a9bcd409c2b96d6ba1d3f4562a
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/fa9ebfe2ca829f8a8fdabb93a58a1b776da589a9bcd409c2b96d6ba1d3f4562a/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=37d0f7388c9f91d90ba42a33c51c11e69f9c2aa383127caaa8e1dd428033ca34
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/37d0f7388c9f91d90ba42a33c51c11e69f9c2aa383127caaa8e1dd428033ca34/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f1bfa7a127ecbdc4034394226f527ded05144d8ba0c86de00e347b8434a97f3d
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f1bfa7a127ecbdc4034394226f527ded05144d8ba0c86de00e347b8434a97f3d/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=dd32ea997e60e322bd6438bb58f8395a13d52de5d3cd0b43a150511bcd7059b4
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/dd32ea997e60e322bd6438bb58f8395a13d52de5d3cd0b43a150511bcd7059b4/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e492f3685e02b41da83bc91d684edbfe9f442f644fac6e6b3f91e047a9ebf309
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e492f3685e02b41da83bc91d684edbfe9f442f644fac6e6b3f91e047a9ebf309/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=fbbcef148213b33e190a797ab9d309b4048926b9bfa7525caaef20413f5a2a0f
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/fbbcef148213b33e190a797ab9d309b4048926b9bfa7525caaef20413f5a2a0f/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=fdd091437397de79ff9643029e07d39a151c375b1e7fe0b8b2037617bd5c2cd0
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/fdd091437397de79ff9643029e07d39a151c375b1e7fe0b8b2037617bd5c2cd0/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS100_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=AqlcEyZ2- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 17:26:47 [INFO] log mode: WRITELOG
finished ReadRatio0.1_QPS100_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_read
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.3
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ tr -dc a-zA-Z0-9
++ head -n 1
++ fold -w 8
++ head -c 64 /dev/urandom
+ TABLE_PREFIX=SxZTaI7i
+ TABLE_PREFIX=SxZTaI7i-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=SxZTaI7i- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 17:28:37 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=SxZTaI7i- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 17:28:46 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=SxZTaI7i- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.3 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_boki-controller
Creating service boki_boki-sequencer
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=45db1c8e3f5bdb4578d4b1c129836929fccbaa7b8299b61cb96abf98e411c1ad
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/45db1c8e3f5bdb4578d4b1c129836929fccbaa7b8299b61cb96abf98e411c1ad/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=72f3f9713257024c7f4ebff692b46b0f60eab94f838b2e24044a4319144de53e
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/72f3f9713257024c7f4ebff692b46b0f60eab94f838b2e24044a4319144de53e/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=365f3c1be446ee2dc07630da2f93e97f7bcb561d46fe9a89a6852d34a39ff69f
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/365f3c1be446ee2dc07630da2f93e97f7bcb561d46fe9a89a6852d34a39ff69f/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ad631d8f4aac9352347a942aebb61e733f8338804c27d61effcb164fcf0cb171
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ad631d8f4aac9352347a942aebb61e733f8338804c27d61effcb164fcf0cb171/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9592e6d02f30f399d5e92ab2a974bb65d31ee5a3e23103e797977ce105e6fb9f
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9592e6d02f30f399d5e92ab2a974bb65d31ee5a3e23103e797977ce105e6fb9f/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=70cc22f5cfe5c9110592103820c92ffeea050ef0d6de1ef9688a73c40949df9b
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/70cc22f5cfe5c9110592103820c92ffeea050ef0d6de1ef9688a73c40949df9b/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6228511b0685270a0a710564e5342a6ecd6845b8a14775bbb31cd3f5e3fd72ed
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6228511b0685270a0a710564e5342a6ecd6845b8a14775bbb31cd3f5e3fd72ed/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f1b3964bd1dac77f83b46166cda39ffedf6369ed0a65f2147c99b1078708b86b
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f1b3964bd1dac77f83b46166cda39ffedf6369ed0a65f2147c99b1078708b86b/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=SxZTaI7i- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 17:44:39 [INFO] log mode: READLOG
finished ReadRatio0.3_QPS100_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_write
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.3
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ fold -w 8
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
++ head -n 1
+ TABLE_PREFIX=TLVRHUZw
+ TABLE_PREFIX=TLVRHUZw-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=TLVRHUZw- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 17:46:28 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=TLVRHUZw- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 17:46:37 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=TLVRHUZw- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.3 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-sequencer
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_prewarm-service
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-storage
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=7d894f7fd895fad5eb52d28e32c0f0cbbc8b93191c044deac0163b90f0c47690
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/7d894f7fd895fad5eb52d28e32c0f0cbbc8b93191c044deac0163b90f0c47690/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9d329b0e4ff847256e2f94d42f1171a956b4d6fd4efcd8cfe021d38ef288e143
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9d329b0e4ff847256e2f94d42f1171a956b4d6fd4efcd8cfe021d38ef288e143/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=b8f6a7f56d769756fd521081ca66df0b417882e12b931f1557a8d5d7751b2135
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/b8f6a7f56d769756fd521081ca66df0b417882e12b931f1557a8d5d7751b2135/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ca677f7689dc28444d992245785f50fec51ce05eb02caa66d636ba1b6204e49d
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ca677f7689dc28444d992245785f50fec51ce05eb02caa66d636ba1b6204e49d/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=465e923757afdbe28e8c6d1cfd8bd9531e9a9e0834460f5c5fe2420b68470141
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/465e923757afdbe28e8c6d1cfd8bd9531e9a9e0834460f5c5fe2420b68470141/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=7c8b59488ea13567b59fd17bb5e0f850f3096d41584aa74250fdef93a52d0f11
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/7c8b59488ea13567b59fd17bb5e0f850f3096d41584aa74250fdef93a52d0f11/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e8d87da2a472199e46ba0ebec20ba042b0e41b95158300e523cca0a7ed170be5
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e8d87da2a472199e46ba0ebec20ba042b0e41b95158300e523cca0a7ed170be5/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0509acafd09fa3c1a7625e34756c5ee049414dc78956d408b1cb5063bb402d07
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0509acafd09fa3c1a7625e34756c5ee049414dc78956d408b1cb5063bb402d07/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS100_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=TLVRHUZw- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 18:04:59 [INFO] log mode: WRITELOG
finished ReadRatio0.3_QPS100_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_read
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.5
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ fold -w 8
++ head -n 1
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
+ TABLE_PREFIX=LAikPAjG
+ TABLE_PREFIX=LAikPAjG-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=LAikPAjG- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 18:06:49 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=LAikPAjG- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 18:06:58 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=LAikPAjG- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.5 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_boki-controller
Creating service boki_boki-storage
Creating service boki_zookeeper-setup
Creating service boki_boki-engine
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d7268e2485e445951bc529665e4e876ba34da0edafe9625284c2732fb20ce5e4
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d7268e2485e445951bc529665e4e876ba34da0edafe9625284c2732fb20ce5e4/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a134397ee724d4b794e783397cd4ebd78fedf8c55ec50e951d91eff0c13e003d
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a134397ee724d4b794e783397cd4ebd78fedf8c55ec50e951d91eff0c13e003d/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=96b452acd5b0c7584292d6cb5093374601d2a4fbad77169ce1fb880111163dc3
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/96b452acd5b0c7584292d6cb5093374601d2a4fbad77169ce1fb880111163dc3/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f10a3e5b3e441cd5ee7d78beb7dbd183eb65e7e34df422dfa4dbd7453fcae134
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f10a3e5b3e441cd5ee7d78beb7dbd183eb65e7e34df422dfa4dbd7453fcae134/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d4fe709fdb40e15ce4de3e35d3afa5cb2f1728edf8aaf4482d7a350eb94287b7
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d4fe709fdb40e15ce4de3e35d3afa5cb2f1728edf8aaf4482d7a350eb94287b7/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=36fdaf4b3b165522d34323629c41cd09d56ad2cfef57d95c73682020054bdd86
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/36fdaf4b3b165522d34323629c41cd09d56ad2cfef57d95c73682020054bdd86/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=64b31ee9a652456ea99ae6795b08febc86e7249708f969ba37732aab95305222
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/64b31ee9a652456ea99ae6795b08febc86e7249708f969ba37732aab95305222/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=3eb620083b73eda3008ea72417f8108bc89dcc6b0d24b9a2ce14ea98d47e4d0a
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/3eb620083b73eda3008ea72417f8108bc89dcc6b0d24b9a2ce14ea98d47e4d0a/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=LAikPAjG- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 18:22:41 [INFO] log mode: READLOG
finished ReadRatio0.5_QPS100_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_write
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.5
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ fold -w 8
++ head -n 1
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
+ TABLE_PREFIX=GdzagRPN
+ TABLE_PREFIX=GdzagRPN-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=GdzagRPN- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 18:24:30 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=GdzagRPN- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 18:24:36 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=GdzagRPN- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.5 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_rw-service
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_prewarm-service
Creating service boki_boki-storage
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a3f0be8a90c8d6fd73495834549ecc3d9fc79dadf498c7df3f54994492fd7fea
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a3f0be8a90c8d6fd73495834549ecc3d9fc79dadf498c7df3f54994492fd7fea/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ff3d42af66828d0fa811e038ec656205996004ae27788aac430ce9bc4570e7d6
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ff3d42af66828d0fa811e038ec656205996004ae27788aac430ce9bc4570e7d6/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=b805a20da912e6dd361ba48dd008400bc1ccb202691e3d12806cec97dd13cc03
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/b805a20da912e6dd361ba48dd008400bc1ccb202691e3d12806cec97dd13cc03/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=40aea083847b7d96551fa6432631b165ac07eed92db039b14eeefb269dd5972a
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/40aea083847b7d96551fa6432631b165ac07eed92db039b14eeefb269dd5972a/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=4904231bb921b3a4e81f1eda84d069985bc1c1b23f0895fa698cd2bdf127d313
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/4904231bb921b3a4e81f1eda84d069985bc1c1b23f0895fa698cd2bdf127d313/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=443c96d7836d73ffc4bf447856891da5a60b4f1cd165001d30a7c77285c21722
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/443c96d7836d73ffc4bf447856891da5a60b4f1cd165001d30a7c77285c21722/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=b4af0a54ec05b0bb3774cf0282d0d129b341e3ba7369cac33fbc13d697656b20
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/b4af0a54ec05b0bb3774cf0282d0d129b341e3ba7369cac33fbc13d697656b20/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9e68317f23b316b961f07f83f65735a46f698b4394baf65caa621ebd46b479e3
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9e68317f23b316b961f07f83f65735a46f698b4394baf65caa621ebd46b479e3/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS100_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=GdzagRPN- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 18:42:46 [INFO] log mode: WRITELOG
finished ReadRatio0.5_QPS100_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_read
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.7
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ tr -dc a-zA-Z0-9
++ head -c 64 /dev/urandom
++ fold -w 8
+ TABLE_PREFIX=alG9G3CL
+ TABLE_PREFIX=alG9G3CL-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=alG9G3CL- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 18:44:35 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=alG9G3CL- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 18:44:41 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=alG9G3CL- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.7 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-engine
Creating service boki_prewarm-service
Creating service boki_boki-controller
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-gateway
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=df702cf66eba0bae1c793daf73754b8997b3df5eac27dc513915a517d8ca547c
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/df702cf66eba0bae1c793daf73754b8997b3df5eac27dc513915a517d8ca547c/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=29dc5d427fcefcc0b9cf979c6e4772c01bca63ea298d1dd9b6a4a741ce3b8a05
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/29dc5d427fcefcc0b9cf979c6e4772c01bca63ea298d1dd9b6a4a741ce3b8a05/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=55fdd8c4c4cfed9628fbf7b08cb98b01295135cd75ec9312e00917bc38256665
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/55fdd8c4c4cfed9628fbf7b08cb98b01295135cd75ec9312e00917bc38256665/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=cd7c018467631c2ea8544470093f9033cb1ea5b91c9ca9019a80cef64a2fcc8f
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/cd7c018467631c2ea8544470093f9033cb1ea5b91c9ca9019a80cef64a2fcc8f/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a56701d90e1bd6ad0c156b2d79c52aa41a542361c6f0d4029deaf7811f4f6c8e
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a56701d90e1bd6ad0c156b2d79c52aa41a542361c6f0d4029deaf7811f4f6c8e/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=5dd4df976a64e6265f21411c2f50b15dc50aeb7c5caf7b67de3b5039b9c978ff
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/5dd4df976a64e6265f21411c2f50b15dc50aeb7c5caf7b67de3b5039b9c978ff/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ddff088cc5b366d2df95f5563c887dc14923861a977d3d457bf7677853745915
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ddff088cc5b366d2df95f5563c887dc14923861a977d3d457bf7677853745915/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e9b9b85107f2a79802a16c822bd9a94aea55775ef136fb70a7b0e734a3a83fcf
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e9b9b85107f2a79802a16c822bd9a94aea55775ef136fb70a7b0e734a3a83fcf/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=alG9G3CL- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 19:00:26 [INFO] log mode: READLOG
finished ReadRatio0.7_QPS100_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_write
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.7
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ tr -dc a-zA-Z0-9
++ head -c 64 /dev/urandom
++ head -n 1
++ fold -w 8
+ TABLE_PREFIX=avDDXP57
+ TABLE_PREFIX=avDDXP57-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=avDDXP57- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 19:02:16 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=avDDXP57- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 19:02:22 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=avDDXP57- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.7 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_zookeeper-setup
Creating service boki_boki-controller
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_boki-engine
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9cd2dc038bbff4dc11eb91912f7f54f04af802b31921cb179e1593683c8ff66c
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9cd2dc038bbff4dc11eb91912f7f54f04af802b31921cb179e1593683c8ff66c/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=dbec955fff67a3ce6f8bbf64345d0e8615a2ebcd84a0b3ca3f48c2ca8b0d5b8c
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/dbec955fff67a3ce6f8bbf64345d0e8615a2ebcd84a0b3ca3f48c2ca8b0d5b8c/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f9defc979cbd518c93b725416df82b1ed943eb8aebfec6116753975d4d1097e1
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f9defc979cbd518c93b725416df82b1ed943eb8aebfec6116753975d4d1097e1/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=fedacd8062e10afe6684b261d7da9d2e0b58cf6a1bdeeb43016608dc6ba06a1c
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/fedacd8062e10afe6684b261d7da9d2e0b58cf6a1bdeeb43016608dc6ba06a1c/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f87b24721e1c46524be73ed792bc6d5bad36177c38ee5fe394127f05910bad2c
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f87b24721e1c46524be73ed792bc6d5bad36177c38ee5fe394127f05910bad2c/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e3964987b8ddec0ec6277ebb4007ae1a1a463cfcc5f73384efddda98dd1e1e34
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e3964987b8ddec0ec6277ebb4007ae1a1a463cfcc5f73384efddda98dd1e1e34/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=3db2dff46f8115cebd4778dfbc13d9acc5e008a66d0b084a27000a930e0b3e59
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/3db2dff46f8115cebd4778dfbc13d9acc5e008a66d0b084a27000a930e0b3e59/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=3935d8b51ce3c423c58d0f54edcc812248f8b2a7691417611e492319680becb5
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/3935d8b51ce3c423c58d0f54edcc812248f8b2a7691417611e492319680becb5/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS100_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=avDDXP57- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 19:20:39 [INFO] log mode: WRITELOG
finished ReadRatio0.7_QPS100_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_read
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.9
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ fold -w 8
++ tr -dc a-zA-Z0-9
++ head -c 64 /dev/urandom
++ head -n 1
+ TABLE_PREFIX=IRr6UCcx
+ TABLE_PREFIX=IRr6UCcx-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=IRr6UCcx- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 19:22:28 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=IRr6UCcx- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 19:22:37 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=IRr6UCcx- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.9 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-engine
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_zookeeper-setup
Creating service boki_boki-controller
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_boki-gateway
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=acaa59cd660745782bbe4a740ff2ccffafa99fda993d79374f61283df407fb84
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/acaa59cd660745782bbe4a740ff2ccffafa99fda993d79374f61283df407fb84/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e34191c73882079bb68f870255b622010d7eabd1a95b98a2c8940caecafad9b7
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e34191c73882079bb68f870255b622010d7eabd1a95b98a2c8940caecafad9b7/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=12d1ea94e83936a477cd8642c6ea7063a4d6ea18a1765b4c731d462e719027bc
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/12d1ea94e83936a477cd8642c6ea7063a4d6ea18a1765b4c731d462e719027bc/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=cbc40be29579fcb2638ce612579444d9ba75d57bf9f034c3c4a21297203636fb
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/cbc40be29579fcb2638ce612579444d9ba75d57bf9f034c3c4a21297203636fb/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=164dc7fdd6da12075a6619a9cd54eef19ec9cdcf1344536cbb3167578947b350
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/164dc7fdd6da12075a6619a9cd54eef19ec9cdcf1344536cbb3167578947b350/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=17ccb2d3bd76181335f3579e0ac4ab9e79f0dcc8200f833ca01a5ec5da0fd9c1
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/17ccb2d3bd76181335f3579e0ac4ab9e79f0dcc8200f833ca01a5ec5da0fd9c1/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6dbd973f7f760198b3d5b942c885ebc53bb09a3f61a107b99ffc8c3361d2bbc8
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6dbd973f7f760198b3d5b942c885ebc53bb09a3f61a107b99ffc8c3361d2bbc8/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=4288248fad9aca586a03d81a1039611014411001bc8062735bd4c534efce0b82
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/4288248fad9aca586a03d81a1039611014411001bc8062735bd4c534efce0b82/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=IRr6UCcx- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 19:38:29 [INFO] log mode: READLOG
finished ReadRatio0.9_QPS100_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_write
+ QPS=100
+ NUM_OPS=10
+ READ_RATIO=0.9
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ fold -w 8
++ tr -dc a-zA-Z0-9
++ head -c 64 /dev/urandom
+ TABLE_PREFIX=5F64tqtd
+ TABLE_PREFIX=5F64tqtd-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=5F64tqtd- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 19:40:19 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=5F64tqtd- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 19:40:25 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=5F64tqtd- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.9 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-engine
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_rw-service
Creating service boki_boki-controller
Creating service boki_boki-gateway
Creating service boki_prewarm-service
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=12cfc95cfd4ed029bb4faffc446cf432cb345469f816ee4884ebb597bc4aa1cf
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/12cfc95cfd4ed029bb4faffc446cf432cb345469f816ee4884ebb597bc4aa1cf/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=3b3e3aadecc2c31d2a5faec4212cd0a965755c33a7634d8456eed90f2b6111a8
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/3b3e3aadecc2c31d2a5faec4212cd0a965755c33a7634d8456eed90f2b6111a8/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0853a3e7b22e0d4de8d41869be8f62eaadba7de1a45f1e24ff73bfaedfbd7184
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0853a3e7b22e0d4de8d41869be8f62eaadba7de1a45f1e24ff73bfaedfbd7184/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=8970b6f5b6cc92f229a0031af8edbaf4229803d48a129af6c8009c57804cde2e
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/8970b6f5b6cc92f229a0031af8edbaf4229803d48a129af6c8009c57804cde2e/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6929b9e98c5acdd60d30690a1f33cb1a1d433db9a668d7d2326d81fedb9c0f63
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6929b9e98c5acdd60d30690a1f33cb1a1d433db9a668d7d2326d81fedb9c0f63/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1c7706892cd99ce981d032069fbb4c0b6cec9f56296d28d3aa18236f0158695e
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1c7706892cd99ce981d032069fbb4c0b6cec9f56296d28d3aa18236f0158695e/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=64836e2fcd3b6940ef30a483f0f2f5d86939c63e695243d343d7b9535f1a68aa
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/64836e2fcd3b6940ef30a483f0f2f5d86939c63e695243d343d7b9535f1a68aa/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0e5ce1557eef3e859485f1bd7ae2d40167f83bb1b9591e541c67a348e2336ad4
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0e5ce1557eef3e859485f1bd7ae2d40167f83bb1b9591e541c67a348e2336ad4/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 100
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS100_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=5F64tqtd- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 19:58:46 [INFO] log mode: WRITELOG
finished ReadRatio0.9_QPS100_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_read
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.1
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ fold -w 8
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
+ TABLE_PREFIX=HdMMbVWg
+ TABLE_PREFIX=HdMMbVWg-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=HdMMbVWg- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 20:00:35 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=HdMMbVWg- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 20:00:42 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=HdMMbVWg- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.1 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_zookeeper-setup
Creating service boki_boki-sequencer
Creating service boki_zookeeper
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=5ccf790d153df09fb8c279d953fee10b2d0bd849da4b72e2618b20425b4c738f
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/5ccf790d153df09fb8c279d953fee10b2d0bd849da4b72e2618b20425b4c738f/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1e4c8c8d58cbb20e7fff86f31243cc0254a6cf6caee9cd08c09948e72882a626
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1e4c8c8d58cbb20e7fff86f31243cc0254a6cf6caee9cd08c09948e72882a626/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=c54fc9605e2a5b3a7665d196de1ab33af6105579ae18cf504ba48bc543b75838
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/c54fc9605e2a5b3a7665d196de1ab33af6105579ae18cf504ba48bc543b75838/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=3b27d358c80404b89d5341b214fff41dd52f91d8928136df28ca21d8d37154bc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/3b27d358c80404b89d5341b214fff41dd52f91d8928136df28ca21d8d37154bc/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d1be5244b0d5b7297a8bc27f6c6e7c6ddfc46b5c7a6273e900653b6cae5fa0e2
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d1be5244b0d5b7297a8bc27f6c6e7c6ddfc46b5c7a6273e900653b6cae5fa0e2/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e8d931398b5f1fe205c390c8bbaffcd75c172d708444724f791b51504d79e6bb
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e8d931398b5f1fe205c390c8bbaffcd75c172d708444724f791b51504d79e6bb/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=69d608660440de3bcf0293b5641c0696c5eea65ee304acb720c4fffe5fce5d5e
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/69d608660440de3bcf0293b5641c0696c5eea65ee304acb720c4fffe5fce5d5e/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=779078c46e00686cf77ad74eeb70a419c958b41200e4e11b246a88b9052fc538
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/779078c46e00686cf77ad74eeb70a419c958b41200e4e11b246a88b9052fc538/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=HdMMbVWg- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 20:16:37 [INFO] log mode: READLOG
finished ReadRatio0.1_QPS200_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_write
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.1
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ tr -dc a-zA-Z0-9
++ head -n 1
++ head -c 64 /dev/urandom
++ fold -w 8
+ TABLE_PREFIX=BieV4t8S
+ TABLE_PREFIX=BieV4t8S-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=BieV4t8S- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 20:18:26 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=BieV4t8S- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 20:18:32 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=BieV4t8S- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.1 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_zookeeper-setup
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d053cb7d606618d444e628c7c4ef94f95724d2f0c172b2d718c3c7ff4037f4c6
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d053cb7d606618d444e628c7c4ef94f95724d2f0c172b2d718c3c7ff4037f4c6/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=3b037cf065bb00f6e1c8e03c449d002b6a759258ab5526dbe28196bd8a37659a
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/3b037cf065bb00f6e1c8e03c449d002b6a759258ab5526dbe28196bd8a37659a/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f8db69d929925390189255fbc25d52bb25bb0ea072f55b4b727e8dec799154a7
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f8db69d929925390189255fbc25d52bb25bb0ea072f55b4b727e8dec799154a7/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ff348b141a52d4432eac1a17d060c50051377bd94fda8691e2a57ad9eea4006f
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ff348b141a52d4432eac1a17d060c50051377bd94fda8691e2a57ad9eea4006f/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=66696dba2d02e26b6f6f2a148ced27b74b1e63fa8fcd4e0deb473e2114661e5a
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/66696dba2d02e26b6f6f2a148ced27b74b1e63fa8fcd4e0deb473e2114661e5a/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=dc4c0395fb63e838c121a88ad9f65a707d606709203984f97fb0d5676e0bd03a
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/dc4c0395fb63e838c121a88ad9f65a707d606709203984f97fb0d5676e0bd03a/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1227387796b13edbcb235b6b8be42dfa4171b9bdfbb43f4e3f421e4c6063fc85
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1227387796b13edbcb235b6b8be42dfa4171b9bdfbb43f4e3f421e4c6063fc85/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=b1e4f65b1295ba689812c4835a00d74c7a05a5d82390a8644c995a2f87d14e6e
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/b1e4f65b1295ba689812c4835a00d74c7a05a5d82390a8644c995a2f87d14e6e/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS200_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=BieV4t8S- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 20:39:43 [INFO] log mode: WRITELOG
finished ReadRatio0.1_QPS200_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_read
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.3
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
++ fold -w 8
+ TABLE_PREFIX=RSaivmD8
+ TABLE_PREFIX=RSaivmD8-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=RSaivmD8- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 20:41:32 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=RSaivmD8- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 20:41:39 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=RSaivmD8- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.3 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-storage
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-controller
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_boki-sequencer
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6b9681d014babf5141d09ce9334cdf6fddfd8f7efa909bef7520a0d2cbf9f811
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6b9681d014babf5141d09ce9334cdf6fddfd8f7efa909bef7520a0d2cbf9f811/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=8fa3b0c56667d91d3c274348a342761a47fe746f5f1dc1c628ef00d1fc24e05c
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/8fa3b0c56667d91d3c274348a342761a47fe746f5f1dc1c628ef00d1fc24e05c/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f5156101ce67bf21976421baa923a5f873438d140bfc60c6f09bcaaeb9644446
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f5156101ce67bf21976421baa923a5f873438d140bfc60c6f09bcaaeb9644446/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e3fae4c32fada7752aab94cfeea77a0e8be74e541554728c0542fea477601310
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e3fae4c32fada7752aab94cfeea77a0e8be74e541554728c0542fea477601310/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6dcb8ad15571fd8ea51713ce23cfef3bc5f2b45b707def0da22a3262bd08b1dc
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6dcb8ad15571fd8ea51713ce23cfef3bc5f2b45b707def0da22a3262bd08b1dc/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0eec5518d208acc91551abcb7da0312cdf906df03afcd7ed9705dc12e1f94e6a
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0eec5518d208acc91551abcb7da0312cdf906df03afcd7ed9705dc12e1f94e6a/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1af2bd4c5fd9dd13747386d58e9e2bc667ad881637e6bb31c3087a7d557d0383
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1af2bd4c5fd9dd13747386d58e9e2bc667ad881637e6bb31c3087a7d557d0383/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e3975c021ef327a03406702715d50d70d28472c9119d6fc49679f9c733cfe272
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e3975c021ef327a03406702715d50d70d28472c9119d6fc49679f9c733cfe272/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=RSaivmD8- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 20:57:32 [INFO] log mode: READLOG
finished ReadRatio0.3_QPS200_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_write
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.3
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ fold -w 8
++ head -n 1
++ tr -dc a-zA-Z0-9
++ head -c 64 /dev/urandom
+ TABLE_PREFIX=QdzpDdLP
+ TABLE_PREFIX=QdzpDdLP-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=QdzpDdLP- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 20:59:21 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=QdzpDdLP- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 20:59:31 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=QdzpDdLP- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.3 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-gateway
Creating service boki_prewarm-service
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_boki-controller
Creating service boki_boki-engine
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a8ad354952a4c5bdd1b932855f53ba62e4895d203be752b2b38d3bc9b03b8e21
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a8ad354952a4c5bdd1b932855f53ba62e4895d203be752b2b38d3bc9b03b8e21/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=216a228c973adf64ce14746d871055b064ceec8c49620f080dde01e48ce30207
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/216a228c973adf64ce14746d871055b064ceec8c49620f080dde01e48ce30207/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1127b89934b240a27a2ed6700690bf74c47f2402ece3e4af3a632e873db1eaba
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1127b89934b240a27a2ed6700690bf74c47f2402ece3e4af3a632e873db1eaba/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ab4045d7df4cc274e105c757c58e25a413fc8b5fbf4f383a7c321a1a936abae5
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ab4045d7df4cc274e105c757c58e25a413fc8b5fbf4f383a7c321a1a936abae5/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=597b9038ef20b1e88a47db9313c44cb459fdcb58c29a8a2b896bb3bc68595972
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/597b9038ef20b1e88a47db9313c44cb459fdcb58c29a8a2b896bb3bc68595972/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ed5696b5bdaa9386c7d895d123341ece3b4e5df0fbe914cff6e87f75a1a58b26
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ed5696b5bdaa9386c7d895d123341ece3b4e5df0fbe914cff6e87f75a1a58b26/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a5496ee244b1822c27e05ce3eb5f1d8154d35465e51f421951a93c8b76f3a77b
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a5496ee244b1822c27e05ce3eb5f1d8154d35465e51f421951a93c8b76f3a77b/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=46ea32abe65ecff9a5ce43287293eba0cba699843a967fe15eeb68144c439769
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/46ea32abe65ecff9a5ce43287293eba0cba699843a967fe15eeb68144c439769/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS200_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=QdzpDdLP- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 21:20:32 [INFO] log mode: WRITELOG
finished ReadRatio0.3_QPS200_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_read
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.5
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ fold -w 8
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
+ TABLE_PREFIX=90XYjZL4
+ TABLE_PREFIX=90XYjZL4-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=90XYjZL4- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 21:22:21 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=90XYjZL4- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 21:22:28 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=90XYjZL4- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.5 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-controller
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_rw-service
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e9ec8175a40f24decf926d6e8ff481f3f0ebdb6be6d66e090b7c4fbff8c3c4b7
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e9ec8175a40f24decf926d6e8ff481f3f0ebdb6be6d66e090b7c4fbff8c3c4b7/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=420ab6a73bffb6d6b2ae000cfecf5202dab2cfc0138e823d58eab17aa5e92bc5
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/420ab6a73bffb6d6b2ae000cfecf5202dab2cfc0138e823d58eab17aa5e92bc5/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=5bbb17ebb76c2cf1427fe878a60cd476309687c46a826f58fd176bf88409683a
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/5bbb17ebb76c2cf1427fe878a60cd476309687c46a826f58fd176bf88409683a/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=5f6e9603eb0655454f856f25c33aeba9446c46564e0010b5f97db02e24280a75
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/5f6e9603eb0655454f856f25c33aeba9446c46564e0010b5f97db02e24280a75/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=46616d5917a841d9c6d00563f2171b299eae028bf42814016786a1b0e38bcac1
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/46616d5917a841d9c6d00563f2171b299eae028bf42814016786a1b0e38bcac1/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=2935d0ba1cdccd276f3b579a36cc2232c93a982a151d7c8364bd93a9bf0c4f9c
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/2935d0ba1cdccd276f3b579a36cc2232c93a982a151d7c8364bd93a9bf0c4f9c/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e3edd281c31cf43fe0e9c0119d5298f4f9157b42e9e6b443addefeaf229e586e
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e3edd281c31cf43fe0e9c0119d5298f4f9157b42e9e6b443addefeaf229e586e/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=5f2e4b5d957f7d041ce6aa99fc72348605e1016133ba601410bcffd3bb2f9642
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/5f2e4b5d957f7d041ce6aa99fc72348605e1016133ba601410bcffd3bb2f9642/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=90XYjZL4- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 21:38:27 [INFO] log mode: READLOG
finished ReadRatio0.5_QPS200_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_write
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.5
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ fold -w 8
++ tr -dc a-zA-Z0-9
++ head -c 64 /dev/urandom
++ head -n 1
+ TABLE_PREFIX=1kgy4KL3
+ TABLE_PREFIX=1kgy4KL3-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=1kgy4KL3- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 21:40:17 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=1kgy4KL3- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 21:40:23 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=1kgy4KL3- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.5 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-engine
Creating service boki_boki-sequencer
Creating service boki_prewarm-service
Creating service boki_zookeeper
Creating service boki_boki-controller
Creating service boki_boki-gateway
Creating service boki_boki-storage
Creating service boki_rw-service
Creating service boki_zookeeper-setup
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=fdf988fbf3d14c695e100d69401e1be5fef56c7d1e4ce3e6a71be18a8e3eeefa
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/fdf988fbf3d14c695e100d69401e1be5fef56c7d1e4ce3e6a71be18a8e3eeefa/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=777c1dec039eb3cd1fd086c62340c15787027f887b11cae3b4f2478ca4155bc5
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/777c1dec039eb3cd1fd086c62340c15787027f887b11cae3b4f2478ca4155bc5/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=aa5f8a3090e74e7168c201ffb2c924403185ed1319837a262175601d94937d0d
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/aa5f8a3090e74e7168c201ffb2c924403185ed1319837a262175601d94937d0d/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=97bba6f87abb18f3a702a72004e2d096811a4748a442b8d2b44f9a4cc0cf953d
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/97bba6f87abb18f3a702a72004e2d096811a4748a442b8d2b44f9a4cc0cf953d/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=cc861a7469b6cf36226b302be3216f364c5d2675ad6dd4aeb157ed1485e6ed9e
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/cc861a7469b6cf36226b302be3216f364c5d2675ad6dd4aeb157ed1485e6ed9e/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e5fe0eabcfe1236e747fa7a6df85adf658a62a99f02e834b67ec00cfa73934ef
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e5fe0eabcfe1236e747fa7a6df85adf658a62a99f02e834b67ec00cfa73934ef/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=69a2af9121011dbb2afa03d66b6300e2c461477e71cd9399e8338c4345be7273
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/69a2af9121011dbb2afa03d66b6300e2c461477e71cd9399e8338c4345be7273/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=955670598fda4e6af3be9394949296b79d40c76be68b5859cb1aec62c657d6ec
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/955670598fda4e6af3be9394949296b79d40c76be68b5859cb1aec62c657d6ec/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS200_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=1kgy4KL3- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 22:01:20 [INFO] log mode: WRITELOG
finished ReadRatio0.5_QPS200_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_read
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.7
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ tr -dc a-zA-Z0-9
++ head -n 1
++ head -c 64 /dev/urandom
++ fold -w 8
+ TABLE_PREFIX=i7xdRpmW
+ TABLE_PREFIX=i7xdRpmW-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=i7xdRpmW- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 22:03:10 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=i7xdRpmW- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 22:03:19 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=i7xdRpmW- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.7 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_rw-service
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-storage
Creating service boki_boki-sequencer
Creating service boki_prewarm-service
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=112aaaaeaf7edbcc1c6e82c842bb7cd3892539c05d0118889d6da80bcd27e646
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/112aaaaeaf7edbcc1c6e82c842bb7cd3892539c05d0118889d6da80bcd27e646/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=8e11e85de53b474767150da8338a64e54a5f0a4e252e3895c59745c0e8bef86c
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/8e11e85de53b474767150da8338a64e54a5f0a4e252e3895c59745c0e8bef86c/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=030fc953342243f6cf2f76344f7e22334bd9d0082dd98bd49fba178c3106f2d9
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/030fc953342243f6cf2f76344f7e22334bd9d0082dd98bd49fba178c3106f2d9/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=bb546e3386f7a421aac45f1cd4cb5921b2dbd525422e63902e7bed57336e2655
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/bb546e3386f7a421aac45f1cd4cb5921b2dbd525422e63902e7bed57336e2655/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=480eea873deb289938311563b46ea552d9baebec8fab7aea6c49b22b42c21263
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/480eea873deb289938311563b46ea552d9baebec8fab7aea6c49b22b42c21263/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9ffb90f4022b9af3c956450dfc9ffa275978acd4d8e391ab0afaa3f067b79e48
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9ffb90f4022b9af3c956450dfc9ffa275978acd4d8e391ab0afaa3f067b79e48/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1944cc6580a4614eefd4b208c8de34897f980870ca5531a526f8a4859f3b9960
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1944cc6580a4614eefd4b208c8de34897f980870ca5531a526f8a4859f3b9960/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=cb0612a8872f4b3d6413259ad9419339fc82199ef21d20cf38008071e542ae8e
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/cb0612a8872f4b3d6413259ad9419339fc82199ef21d20cf38008071e542ae8e/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=i7xdRpmW- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 22:19:18 [INFO] log mode: READLOG
finished ReadRatio0.7_QPS200_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_write
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.7
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
++ fold -w 8
+ TABLE_PREFIX=UzA65bHU
+ TABLE_PREFIX=UzA65bHU-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=UzA65bHU- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 22:21:07 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=UzA65bHU- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 22:21:17 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=UzA65bHU- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.7 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-controller
Creating service boki_prewarm-service
Creating service boki_zookeeper
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_rw-service
Creating service boki_zookeeper-setup
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=29da6485342142ab5b78586ea37eb3fe69f2e39e18def3ad587d25997e2744bb
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/29da6485342142ab5b78586ea37eb3fe69f2e39e18def3ad587d25997e2744bb/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f591fccac166e51e022bf13706dc570e67b631da52441b37e640929ce6beb2a6
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f591fccac166e51e022bf13706dc570e67b631da52441b37e640929ce6beb2a6/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e6f43246d677e4529f5f212975d87e6c1f308b42d3ffe76c397ce319a9506c70
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e6f43246d677e4529f5f212975d87e6c1f308b42d3ffe76c397ce319a9506c70/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=00e51b34bbcd8e670bfd08767f3c4a12b83e0f7002d5f5c5e1360dddd8c75645
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/00e51b34bbcd8e670bfd08767f3c4a12b83e0f7002d5f5c5e1360dddd8c75645/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9c8732c3871a601171779a1a4982ab0fa659683db727dee9937e791bd9720060
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9c8732c3871a601171779a1a4982ab0fa659683db727dee9937e791bd9720060/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d96666d5a94641bfd7ff6ac2092e997c4bcd4d33ad96776261a8782cbb303626
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d96666d5a94641bfd7ff6ac2092e997c4bcd4d33ad96776261a8782cbb303626/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a68be2832a9deb4b1a707f8b51f2f0bfe39eb86c7fb7ebe6f2ba98424ae1bf8b
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a68be2832a9deb4b1a707f8b51f2f0bfe39eb86c7fb7ebe6f2ba98424ae1bf8b/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6c33469b1b9435b9fbd409e47e36c95e98b441870e089774a133f941464cb5af
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6c33469b1b9435b9fbd409e47e36c95e98b441870e089774a133f941464cb5af/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS200_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=UzA65bHU- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 22:42:13 [INFO] log mode: WRITELOG
finished ReadRatio0.7_QPS200_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_read
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.9
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
++ fold -w 8
+ TABLE_PREFIX=rNRJEAte
+ TABLE_PREFIX=rNRJEAte-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=rNRJEAte- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 22:44:03 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=rNRJEAte- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 22:44:12 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=rNRJEAte- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.9 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-sequencer
Creating service boki_prewarm-service
Creating service boki_boki-controller
Creating service boki_boki-gateway
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-engine
Creating service boki_boki-storage
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=146be3a9021fe2b1db5ed5d7d9fe7b4f207241b06c3f82af66c18a222aca1e0b
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/146be3a9021fe2b1db5ed5d7d9fe7b4f207241b06c3f82af66c18a222aca1e0b/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d9c1dc2220dbd6381f193b8e4295e4041cd086b79dfd5c8203db3b83f0e1a2fa
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d9c1dc2220dbd6381f193b8e4295e4041cd086b79dfd5c8203db3b83f0e1a2fa/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=7b740a4befc1c35c5405b4ba9deea4ddf3455e0f17117864ea30f75e4bf3fe7f
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/7b740a4befc1c35c5405b4ba9deea4ddf3455e0f17117864ea30f75e4bf3fe7f/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1d18b98fc9a7c91e2279af5d5706cb0738a8da329c18d07375afad2154f63653
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1d18b98fc9a7c91e2279af5d5706cb0738a8da329c18d07375afad2154f63653/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=73a31269527d3b1a817fcf5e5aaa5092b9384d68e15da34e07e8aec258f1f77e
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/73a31269527d3b1a817fcf5e5aaa5092b9384d68e15da34e07e8aec258f1f77e/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f3863a5c6018204e384db5eb10f83340b89cfd276024bb3ef38b22efac69461f
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f3863a5c6018204e384db5eb10f83340b89cfd276024bb3ef38b22efac69461f/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=8e83885eec6a3b0f8e93fab50312c07c8ed91b420402ccdfb388ae81d87b70a5
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/8e83885eec6a3b0f8e93fab50312c07c8ed91b420402ccdfb388ae81d87b70a5/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9c83621774159e31dfba6cce23e81a022fe1f5bc721bfc7c6180312ae856b49a
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9c83621774159e31dfba6cce23e81a022fe1f5bc721bfc7c6180312ae856b49a/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=rNRJEAte- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 23:00:04 [INFO] log mode: READLOG
finished ReadRatio0.9_QPS200_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_write
+ QPS=200
+ NUM_OPS=10
+ READ_RATIO=0.9
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
++ fold -w 8
+ TABLE_PREFIX=z6wT0HGZ
+ TABLE_PREFIX=z6wT0HGZ-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=z6wT0HGZ- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 23:01:54 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=z6wT0HGZ- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 23:02:00 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=z6wT0HGZ- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.9 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-controller
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_zookeeper-setup
Creating service boki_boki-engine
Creating service boki_zookeeper
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9d26f4bf6f4992bbd24e37a7a7b61167d5107af335faaef6c57db97012c85ff5
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9d26f4bf6f4992bbd24e37a7a7b61167d5107af335faaef6c57db97012c85ff5/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e2b1bbafbd615634082ddc157db2017e50e5c09244086f85a5fb5c2d3922a9ab
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e2b1bbafbd615634082ddc157db2017e50e5c09244086f85a5fb5c2d3922a9ab/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=c89f324a5fa597d0bf70a24bb9535322ec7ef0f8de39a5fedaa105f643fecaac
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/c89f324a5fa597d0bf70a24bb9535322ec7ef0f8de39a5fedaa105f643fecaac/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e25622b13f63389a9ebb9e5774e6b3299be7de310c56e198c4c8059581205ae7
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e25622b13f63389a9ebb9e5774e6b3299be7de310c56e198c4c8059581205ae7/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=638a05e0d2ba750f0732750b5bf77cf9922e113b31b74334e5e4ab5b2a76e7b3
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/638a05e0d2ba750f0732750b5bf77cf9922e113b31b74334e5e4ab5b2a76e7b3/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=33ef84dd3874d6d8dcce2a9fee340ad04a1a8308f20158e55b27236a07529900
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/33ef84dd3874d6d8dcce2a9fee340ad04a1a8308f20158e55b27236a07529900/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f8f2285a32af6768b9ed75354ae64c96f6bee4e711659b507dc7a5980d6be6b3
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f8f2285a32af6768b9ed75354ae64c96f6bee4e711659b507dc7a5980d6be6b3/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a00455eef2ae9a621bed73e14b978b2c7a20a85ff87eb8c972d4515a1d399e21
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a00455eef2ae9a621bed73e14b978b2c7a20a85ff87eb8c972d4515a1d399e21/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 200
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS200_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=z6wT0HGZ- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 23:23:20 [INFO] log mode: WRITELOG
finished ReadRatio0.9_QPS200_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_read
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.1
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ tr -dc a-zA-Z0-9
++ head -n 1
++ fold -w 8
++ head -c 64 /dev/urandom
+ TABLE_PREFIX=likaPCM1
+ TABLE_PREFIX=likaPCM1-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=likaPCM1- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 23:25:09 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=likaPCM1- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 23:25:15 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=likaPCM1- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.1 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-engine
Creating service boki_boki-controller
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9a6f69080e216a61ac42782aeaa1ec8c627528065d478dc51c5cb84a0333c51b
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9a6f69080e216a61ac42782aeaa1ec8c627528065d478dc51c5cb84a0333c51b/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=783a7b02d665cb69c893a39fd37c470314be6b36a25c785e3fa7b012adea74e8
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/783a7b02d665cb69c893a39fd37c470314be6b36a25c785e3fa7b012adea74e8/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0590bcef9c31313bd62b52ec57311f033977453e668d5a8bb9a035570f2e47df
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0590bcef9c31313bd62b52ec57311f033977453e668d5a8bb9a035570f2e47df/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=44df7de0ea5499dcfc00f5d0e118cba83c5746e0ebbec3189f375fd5c4afca11
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/44df7de0ea5499dcfc00f5d0e118cba83c5746e0ebbec3189f375fd5c4afca11/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=b6f43c7077aa87cf7c656251d9d7f580d7cab40f36ddfe485b7aadb15e431f0b
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/b6f43c7077aa87cf7c656251d9d7f580d7cab40f36ddfe485b7aadb15e431f0b/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=53c6ba2bee0843e4db89bf8c3bf7fe0bda0ca0aec65aa9c75a3df9ef60fd9cc2
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/53c6ba2bee0843e4db89bf8c3bf7fe0bda0ca0aec65aa9c75a3df9ef60fd9cc2/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=7f0289043d1d7827101b353261a59e97c066a5cfbaca5f40362325ad8f554e3a
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/7f0289043d1d7827101b353261a59e97c066a5cfbaca5f40362325ad8f554e3a/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=fa1a4c073f0db360ab307d775259009a941fa0f9d0e879aba3bb414d0931a0e2
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/fa1a4c073f0db360ab307d775259009a941fa0f9d0e879aba3bb414d0931a0e2/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=likaPCM1- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/05 23:41:15 [INFO] log mode: READLOG
finished ReadRatio0.1_QPS300_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_write
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.1
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ tr -dc a-zA-Z0-9
++ head -c 64 /dev/urandom
++ fold -w 8
+ TABLE_PREFIX=Wn0HwiNq
+ TABLE_PREFIX=Wn0HwiNq-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=Wn0HwiNq- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/05 23:43:05 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=Wn0HwiNq- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/05 23:43:14 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=Wn0HwiNq- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.1 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-controller
Creating service boki_boki-gateway
Creating service boki_prewarm-service
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-engine
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_rw-service
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=cb91154769cbdf95e1ca2fd4ad9ed10c960ef3344b307f07c3cc5ab0a2996336
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/cb91154769cbdf95e1ca2fd4ad9ed10c960ef3344b307f07c3cc5ab0a2996336/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=928c60854f283c856f6f85c0a7c35e6517c467e004ebe7a137205c2a98057de0
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/928c60854f283c856f6f85c0a7c35e6517c467e004ebe7a137205c2a98057de0/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=5d4446e5a937d781e0aefc5ef152ecdfb1d69d1649839c78f0776f2d701aa6ea
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/5d4446e5a937d781e0aefc5ef152ecdfb1d69d1649839c78f0776f2d701aa6ea/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a02732af6b4dbb5b33be7d631b68455ac53d3b95e64676772c140364d997a7dc
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a02732af6b4dbb5b33be7d631b68455ac53d3b95e64676772c140364d997a7dc/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6cfa30b737e22731c7638f4cddef88cb1c04fb857fa52e3bb4bc9db243af0b67
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6cfa30b737e22731c7638f4cddef88cb1c04fb857fa52e3bb4bc9db243af0b67/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=10acd494de0d040a9096129c91dac82f4290262776532d0947955584fbd852aa
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/10acd494de0d040a9096129c91dac82f4290262776532d0947955584fbd852aa/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=37089f5c7c42f8679d37100f4bb1d60f1dc7735420e6ede0d47d908d57dbb42a
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/37089f5c7c42f8679d37100f4bb1d60f1dc7735420e6ede0d47d908d57dbb42a/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d214df806457970e9c5c65654b77346eab630aca4151640e6a36c596124a8770
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d214df806457970e9c5c65654b77346eab630aca4151640e6a36c596124a8770/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.1_QPS300_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=Wn0HwiNq- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 00:06:51 [INFO] log mode: WRITELOG
finished ReadRatio0.1_QPS300_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_read
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.3
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -c 64 /dev/urandom
++ fold -w 8
++ tr -dc a-zA-Z0-9
++ head -n 1
+ TABLE_PREFIX=0zSirQwI
+ TABLE_PREFIX=0zSirQwI-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=0zSirQwI- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/06 00:08:41 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=0zSirQwI- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/06 00:08:50 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=0zSirQwI- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.3 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_boki-controller
Creating service boki_zookeeper-setup
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=420cdd8e9c61192f29ed23fe610d9723b274c20014a4d57947440b70a8174045
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/420cdd8e9c61192f29ed23fe610d9723b274c20014a4d57947440b70a8174045/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=83f4327001eaf91f5d293b85b1cb8cc2b949e5ce77640b6bd93e7295b3b023f8
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/83f4327001eaf91f5d293b85b1cb8cc2b949e5ce77640b6bd93e7295b3b023f8/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=11f88e38b645b1b3f41ef7a6862c535e84f483fe705ef7064577d73005544932
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/11f88e38b645b1b3f41ef7a6862c535e84f483fe705ef7064577d73005544932/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=5a15a9e1cd4be297eaf59b768c1b3c383b09b99628fd98cf5e045dd0c27c7498
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/5a15a9e1cd4be297eaf59b768c1b3c383b09b99628fd98cf5e045dd0c27c7498/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=6bd3f3ed43e0b68da4ec6c3413f3a8ed248eafaf8d3b8b50bce069538b4f5edf
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/6bd3f3ed43e0b68da4ec6c3413f3a8ed248eafaf8d3b8b50bce069538b4f5edf/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=232b263ab3e22c967d2747007a237e2eeb110d76fc736a3c8b385633a222e8b1
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/232b263ab3e22c967d2747007a237e2eeb110d76fc736a3c8b385633a222e8b1/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f3db82fc844d250947d1b86623894c008a991f0c3d2004c6fa13f45a736c846f
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f3db82fc844d250947d1b86623894c008a991f0c3d2004c6fa13f45a736c846f/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=015ba4396771f30dbbdc19650730a25d159a140a57eac5fd84d9cf0f8e54975e
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/015ba4396771f30dbbdc19650730a25d159a140a57eac5fd84d9cf0f8e54975e/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=0zSirQwI- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 00:24:50 [INFO] log mode: READLOG
finished ReadRatio0.3_QPS300_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_write
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.3
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
++ fold -w 8
++ head -n 1
+ TABLE_PREFIX=bsLxnsKs
+ TABLE_PREFIX=bsLxnsKs-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=bsLxnsKs- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/06 00:26:39 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=bsLxnsKs- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/06 00:26:49 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=bsLxnsKs- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.3 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_boki-controller
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_zookeeper-setup
Creating service boki_zookeeper
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1971ff121f587f88ad22b4d077d44234b681192ab7f55ba732ce2c993e197647
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1971ff121f587f88ad22b4d077d44234b681192ab7f55ba732ce2c993e197647/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1a9d73314913cd7fb675b079651dee15a5228415077754615f7965a2e136e77d
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1a9d73314913cd7fb675b079651dee15a5228415077754615f7965a2e136e77d/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0b45ef0051805eb48088e5b24838591c805e53cc91060aa2aa83711e8997e346
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0b45ef0051805eb48088e5b24838591c805e53cc91060aa2aa83711e8997e346/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=11fcd2eb09561033fbef83acb8f202fc878777362a946316329c5d01c48c6484
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/11fcd2eb09561033fbef83acb8f202fc878777362a946316329c5d01c48c6484/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=dfa5e24f1e97c86da8baeab5bf39efdd615822518c4ee74caa93265f4f0bd7de
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/dfa5e24f1e97c86da8baeab5bf39efdd615822518c4ee74caa93265f4f0bd7de/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=8768a7b7c84bbbc1ca76adb483d50e2518e090b04039a50599548f158f3cf584
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/8768a7b7c84bbbc1ca76adb483d50e2518e090b04039a50599548f158f3cf584/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=213a9c8fd141652873011390ab6a3bfc336107a170718a28112b4263322d292a
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/213a9c8fd141652873011390ab6a3bfc336107a170718a28112b4263322d292a/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0297ff8480e9d26fb110b961d406f9272f746c5eab230870a658fb84947c559a
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0297ff8480e9d26fb110b961d406f9272f746c5eab230870a658fb84947c559a/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.3_QPS300_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=bsLxnsKs- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 00:50:27 [INFO] log mode: WRITELOG
finished ReadRatio0.3_QPS300_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_read
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.5
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ head -c 64 /dev/urandom
++ fold -w 8
++ tr -dc a-zA-Z0-9
+ TABLE_PREFIX=8AgAY5em
+ TABLE_PREFIX=8AgAY5em-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=8AgAY5em- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/06 00:52:16 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=8AgAY5em- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/06 00:52:23 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=8AgAY5em- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.5 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0ebfe86e4ceddc37dc77b4f21b2846a262d6541ef80f1e2b9655b8a87db4f79b
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0ebfe86e4ceddc37dc77b4f21b2846a262d6541ef80f1e2b9655b8a87db4f79b/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9e86a58ae5a4a2ea162f44447afc10cd7f9c5fe00bab7ca961fbd79fc834b3c2
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9e86a58ae5a4a2ea162f44447afc10cd7f9c5fe00bab7ca961fbd79fc834b3c2/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=2cb6b1f798ce7303031cb4323bcb1f57e566342fa0c65da2451db08b4a9af5ef
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/2cb6b1f798ce7303031cb4323bcb1f57e566342fa0c65da2451db08b4a9af5ef/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=28f77e9844f577552ae7171ac2d25ea89078fa22311a30bbe849e48105fd9530
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/28f77e9844f577552ae7171ac2d25ea89078fa22311a30bbe849e48105fd9530/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f886b68bdd3de7a9389c92e078b71f719fa064f0f4bb07cf9bcb9050e5545c52
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f886b68bdd3de7a9389c92e078b71f719fa064f0f4bb07cf9bcb9050e5545c52/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0306cf48a4d725ea877a892ebdfefe4e5c08b524f2e442ead280c50510a82084
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0306cf48a4d725ea877a892ebdfefe4e5c08b524f2e442ead280c50510a82084/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a93b5225baea9828279c46d7695b924424d51c69ab225af253fcaad7c2d45ea4
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a93b5225baea9828279c46d7695b924424d51c69ab225af253fcaad7c2d45ea4/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=38ead55ad60b94ffa9323a5a46aa9e505015084d861b5ff2c83a46563e5072a4
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/38ead55ad60b94ffa9323a5a46aa9e505015084d861b5ff2c83a46563e5072a4/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=8AgAY5em- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 01:08:27 [INFO] log mode: READLOG
finished ReadRatio0.5_QPS300_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_write
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.5
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ fold -w 8
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
+ TABLE_PREFIX=QGFk98Qv
+ TABLE_PREFIX=QGFk98Qv-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=QGFk98Qv- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/06 01:10:16 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=QGFk98Qv- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/06 01:10:23 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=QGFk98Qv- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.5 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_zookeeper-setup
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_zookeeper
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_rw-service
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e4d1716c039c7c1749f2824527dea24baa937248476204634f2ad8b2abb0b1f9
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e4d1716c039c7c1749f2824527dea24baa937248476204634f2ad8b2abb0b1f9/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=b1d6875df070cc6bf492dde8bf33d4454ecca3fa2e1ab2cd628b10920f017b26
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/b1d6875df070cc6bf492dde8bf33d4454ecca3fa2e1ab2cd628b10920f017b26/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=e8a870f326653ffc68e772566e5c4a3033cdb9bf35afd6de03540de093919015
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/e8a870f326653ffc68e772566e5c4a3033cdb9bf35afd6de03540de093919015/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=c3875fbd7b20b7df8bab2e76c6f7dca1ee4590d76bc9c4b8fdf63ee1a6da46b0
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/c3875fbd7b20b7df8bab2e76c6f7dca1ee4590d76bc9c4b8fdf63ee1a6da46b0/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=bd4553774e166c69e8c86c7aab0534b04287dff68d839a1b772b6e86b2310e23
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/bd4553774e166c69e8c86c7aab0534b04287dff68d839a1b772b6e86b2310e23/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=234f244ba9546f48bf661d70e59963d841dddeeff4d1b67531bdbe22981f2a33
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/234f244ba9546f48bf661d70e59963d841dddeeff4d1b67531bdbe22981f2a33/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=23b4d1132a75a243e54801a2ddd186f432c54b03a120d8f14d45caea0e58b447
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/23b4d1132a75a243e54801a2ddd186f432c54b03a120d8f14d45caea0e58b447/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=c36a7e8d42ef6bfe9d97aa7c761f225c251baf64c838e782343c97012f2a88e4
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/c36a7e8d42ef6bfe9d97aa7c761f225c251baf64c838e782343c97012f2a88e4/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.5_QPS300_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=QGFk98Qv- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 01:33:57 [INFO] log mode: WRITELOG
finished ReadRatio0.5_QPS300_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_read
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.7
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ tr -dc a-zA-Z0-9
++ fold -w 8
++ head -n 1
++ head -c 64 /dev/urandom
+ TABLE_PREFIX=OxUenSF8
+ TABLE_PREFIX=OxUenSF8-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=OxUenSF8- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/06 01:35:46 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=OxUenSF8- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/06 01:35:56 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=OxUenSF8- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.7 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_prewarm-service
Creating service boki_rw-service
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_zookeeper
Creating service boki_zookeeper-setup
Creating service boki_boki-controller
Creating service boki_boki-engine
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ecbccf605efdd75bc6d81c661bddc0f8cfaff2b08a6219bb4dc069271fa82d0c
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ecbccf605efdd75bc6d81c661bddc0f8cfaff2b08a6219bb4dc069271fa82d0c/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=813c9c729da517f151f054c7b068b00fd4aaeba37a28d8ef843ae67404773863
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/813c9c729da517f151f054c7b068b00fd4aaeba37a28d8ef843ae67404773863/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=ffb22c250be61cc4aeb90a433ebad20741946ff873d399f3fbe1ccee4a4ce49b
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/ffb22c250be61cc4aeb90a433ebad20741946ff873d399f3fbe1ccee4a4ce49b/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=07b23ae66b14e09ca991081462b2810704e7d8300defe838c4f40c7f03d58cf9
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/07b23ae66b14e09ca991081462b2810704e7d8300defe838c4f40c7f03d58cf9/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=087047b3423bf35d79368413da5d4ffd98d9d67b6d3fde51ed8ae887f81de802
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/087047b3423bf35d79368413da5d4ffd98d9d67b6d3fde51ed8ae887f81de802/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d982db522a5eeec66ba3333add25e8c93871f0128efd6616b5305e0146876ce7
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d982db522a5eeec66ba3333add25e8c93871f0128efd6616b5305e0146876ce7/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=d3a75cf628eeac2a261ad4798192d35910f97ede7900d0bff015873731951a8a
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/d3a75cf628eeac2a261ad4798192d35910f97ede7900d0bff015873731951a8a/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=c72e733dbb78dde1a9e7c56326e063daa63d80e1c176062850675d6c62d3fb65
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/c72e733dbb78dde1a9e7c56326e063daa63d80e1c176062850675d6c62d3fb65/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=OxUenSF8- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 01:52:06 [INFO] log mode: READLOG
finished ReadRatio0.7_QPS300_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_write
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.7
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -n 1
++ head -c 64 /dev/urandom
++ fold -w 8
++ tr -dc a-zA-Z0-9
+ TABLE_PREFIX=ZEd8NnFh
+ TABLE_PREFIX=ZEd8NnFh-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=ZEd8NnFh- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/06 01:53:55 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=ZEd8NnFh- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/06 01:54:05 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=ZEd8NnFh- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.7 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_zookeeper-setup
Creating service boki_boki-storage
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_boki-sequencer
Creating service boki_prewarm-service
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=4f985bec7a274c34eb86835e8f7de35b6dbb8399dabfc5335b6ee799846df46f
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/4f985bec7a274c34eb86835e8f7de35b6dbb8399dabfc5335b6ee799846df46f/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=2bbafbad468b2f095537c3bbbb6928ad2e1b7f02e42302bc6c820a91d2808b17
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/2bbafbad468b2f095537c3bbbb6928ad2e1b7f02e42302bc6c820a91d2808b17/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=8fcd9f79a5f89558177bf8abdb8b3f920011e8d9c01f6583dee551438dc1c967
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/8fcd9f79a5f89558177bf8abdb8b3f920011e8d9c01f6583dee551438dc1c967/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1aca449ecce8a4860813b4732d32d02687ed5029c2f3ed81f94096770f8508fa
+ echo 4096
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1aca449ecce8a4860813b4732d32d02687ed5029c2f3ed81f94096770f8508fa/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=85c53ccc5fdb0ad83b0db3ea4e2f46a716388afc60f3936b33bdfb4e5f5df35d
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/85c53ccc5fdb0ad83b0db3ea4e2f46a716388afc60f3936b33bdfb4e5f5df35d/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=bce7e711ee0d6c42177b9333122a3362388f67253ef0b773de7479ee7bf681e5
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/bce7e711ee0d6c42177b9333122a3362388f67253ef0b773de7479ee7bf681e5/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1d8011fbc97af0208eafb5beb97e33a66f95c67e6e2731aa6fb4cf4dc9ebc05f
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1d8011fbc97af0208eafb5beb97e33a66f95c67e6e2731aa6fb4cf4dc9ebc05f/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=0faaa2cde575f34bf242998b3452acbca29efe6904d355c8f3dee315c1f64995
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/0faaa2cde575f34bf242998b3452acbca29efe6904d355c8f3dee315c1f64995/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.7_QPS300_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=ZEd8NnFh- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 02:18:06 [INFO] log mode: WRITELOG
finished ReadRatio0.7_QPS300_write
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_read
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.9
+ LOGMODE=read
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ head -c 64 /dev/urandom
++ tr -dc a-zA-Z0-9
++ fold -w 8
++ head -n 1
+ TABLE_PREFIX=Ghn0fGqe
+ TABLE_PREFIX=Ghn0fGqe-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=Ghn0fGqe- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/06 02:19:56 [INFO] log mode: READLOG
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=Ghn0fGqe- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/06 02:20:02 [INFO] log mode: READLOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=Ghn0fGqe- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.9 LoggingMode=read docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_rw-service
Creating service boki_zookeeper
Creating service boki_boki-gateway
Creating service boki_boki-sequencer
Creating service boki_boki-storage
Creating service boki_prewarm-service
Creating service boki_zookeeper-setup
Creating service boki_boki-controller
Creating service boki_boki-engine
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=b9db4036c99dbb8f8eb957142534e6ba8c64a22ea5bd12b9513ef75ea51976e4
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/b9db4036c99dbb8f8eb957142534e6ba8c64a22ea5bd12b9513ef75ea51976e4/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=51f51d443bb4e4f240d971417d0d8dfdbdb496e42746f740aec6cd5a33fdc58f
+ echo 4096
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/51f51d443bb4e4f240d971417d0d8dfdbdb496e42746f740aec6cd5a33fdc58f/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=9e38f4e08e2b0e81b8742f64c196b02a468de5e8ddef380bd906e5193913ec00
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/9e38f4e08e2b0e81b8742f64c196b02a468de5e8ddef380bd906e5193913ec00/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=c61a995f0655464e9ea484824f4d454cdb649447b26ebf88730c4078e3334d4b
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/c61a995f0655464e9ea484824f4d454cdb649447b26ebf88730c4078e3334d4b/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=21e73e7d1ef41570f10553f2425b6b0222b6a10f5908cfddf304acca721b321e
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/21e73e7d1ef41570f10553f2425b6b0222b6a10f5908cfddf304acca721b321e/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=a591b7362bf24598ed7fd68fbd1c5439f927bba4e2ee1ac00de87e6e8dbbc9be
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/a591b7362bf24598ed7fd68fbd1c5439f927bba4e2ee1ac00de87e6e8dbbc9be/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=40f543a0b927c862e48f829ba0a74164f4ebb40a23ffe625f3b68b295a714459
+ echo 4096
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/40f543a0b927c862e48f829ba0a74164f4ebb40a23ffe625f3b68b295a714459/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=77140e514e714c256cd148b0c2edec65e843fd595873b693f118a91e81c3b1a7
+ echo 4096
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/77140e514e714c256cd148b0c2edec65e843fd595873b693f118a91e81c3b1a7/cpu.shares
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_read
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_read
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_read
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_read/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_read/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=Ghn0fGqe- AWS_REGION=ap-southeast-1 LoggingMode=read NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 02:35:58 [INFO] log mode: READLOG
finished ReadRatio0.9_QPS300_read
+++ dirname /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_once.sh
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ BASE_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
++ realpath /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/../../..
+ ROOT_DIR=/home/ubuntu/boki-benchmarks
+ BENCH_IMAGE=shengqipku/boki-beldibench:workflow
+ STACK=boki
+ AWS_REGION=ap-southeast-1
+ NUM_KEYS=10000
+ VALUE_SIZE=256
+ EXP_DIR=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_write
+ QPS=300
+ NUM_OPS=10
+ READ_RATIO=0.9
+ LOGMODE=write
+ HELPER_SCRIPT=/home/ubuntu/boki-benchmarks/scripts/exp_helper
+ WRK_DIR=/usr/local/bin
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-docker-manager-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ MANAGER_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-client-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ CLIENT_HOST=ip-172-31-12-251.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-service-host --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service=boki-gateway
+ ENTRY_HOST=ip-172-31-11-118.ap-southeast-1.compute.internal
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-all-server-hosts --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ ALL_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal
ip-172-31-11-118.ap-southeast-1.compute.internal
ip-172-31-14-74.ap-southeast-1.compute.internal
ip-172-31-12-119.ap-southeast-1.compute.internal
ip-172-31-1-115.ap-southeast-1.compute.internal
ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ /home/ubuntu/boki-benchmarks/scripts/exp_helper generate-docker-compose --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/docker-compose-generated.yml 'ip-172-31-11-118.ap-southeast-1.compute.internal:~'
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- docker stack rm boki
Removing service boki_boki-controller
Removing service boki_boki-engine
Removing service boki_boki-gateway
Removing service boki_boki-sequencer
Removing service boki_boki-storage
Removing service boki_prewarm-service
Removing service boki_rw-service
Removing service boki_zookeeper
Removing service boki_zookeeper-setup
Removing network boki_default
+ sleep 40
++ tr -dc a-zA-Z0-9
++ head -c 64 /dev/urandom
++ fold -w 8
++ head -n 1
+ TABLE_PREFIX=sAwR3nvj
+ TABLE_PREFIX=sAwR3nvj-
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker pull shengqipku/boki-beldibench:workflow
workflow: Pulling from shengqipku/boki-beldibench
Digest: sha256:c57fde79b16d5aa3df3eca51642445e387b80e34a3d65a43ecc93e851e968264
Status: Image is up to date for shengqipku/boki-beldibench:workflow
docker.io/shengqipku/boki-beldibench:workflow
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- docker run -v /tmp:/tmp shengqipku/boki-beldibench:workflow cp -r /optimal-bin/rw /tmp/
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=sAwR3nvj- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init create
2023/04/06 02:37:47 [INFO] log mode: WRITELOG
rw status: CREATING
rw status: CREATING
rw status: CREATING
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=sAwR3nvj- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init populate
2023/04/06 02:37:57 [INFO] log mode: WRITELOG
+ scp -q /home/ubuntu/boki-benchmarks/scripts/zk_setup.sh ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/zk_setup.sh
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/store
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-118.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-14-74.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-12-119.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-1-115.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-4-55.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-11-10.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
+ for host in $ALL_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/nightcore_config.json ip-172-31-15-198.ap-southeast-1.compute.internal:/tmp/nightcore_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=engine_node
+ ALL_ENGINE_HOSTS='ip-172-31-6-61.ap-southeast-1.compute.internal
ip-172-31-5-139.ap-southeast-1.compute.internal
ip-172-31-1-237.ap-southeast-1.compute.internal
ip-172-31-4-28.ap-southeast-1.compute.internal
ip-172-31-4-107.ap-southeast-1.compute.internal
ip-172-31-0-93.ap-southeast-1.compute.internal
ip-172-31-13-183.ap-southeast-1.compute.internal
ip-172-31-15-45.ap-southeast-1.compute.internal'
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-6-61.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-5-139.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-1-237.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-28.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-4-107.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-0-93.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-13-183.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
+ for HOST in $ALL_ENGINE_HOSTS
+ scp -q /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/run_launcher ip-172-31-15-45.ap-southeast-1.compute.internal:/tmp/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/inmem/boki/output /mnt/inmem/boki/ipc
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/run_launcher /mnt/inmem/boki/run_launcher
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo cp /tmp/nightcore_config.json /mnt/inmem/boki/func_config.json
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-machine-with-label --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --machine-label=storage_node
+ ALL_STORAGE_HOSTS='ip-172-31-4-55.ap-southeast-1.compute.internal
ip-172-31-11-10.ap-southeast-1.compute.internal
ip-172-31-15-198.ap-southeast-1.compute.internal'
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-4-55.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-11-10.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ for HOST in $ALL_STORAGE_HOSTS
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo rm -rf /mnt/storage/logdata
+ ssh -q ip-172-31-15-198.ap-southeast-1.compute.internal -- sudo mkdir -p /mnt/storage/logdata
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- TABLE_PREFIX=sAwR3nvj- NUM_KEYS=10000 VALUE_SIZE=256 NUM_OPS=10 READ_RATIO=0.9 LoggingMode=write docker stack deploy -c /home/ubuntu/docker-compose-generated.yml -c /home/ubuntu/docker-compose.yml boki
Ignoring unsupported options: restart

Creating network boki_default
Creating service boki_zookeeper-setup
Creating service boki_boki-sequencer
Creating service boki_prewarm-service
Creating service boki_zookeeper
Creating service boki_boki-storage
Creating service boki_rw-service
Creating service boki_boki-controller
Creating service boki_boki-engine
Creating service boki_boki-gateway
+ sleep 80
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-6-61.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=f70bf0c5536c6dee5aa108138d854523e419526052aa0a454ce8a6ef6e6dd998
+ echo 4096
+ ssh -q ip-172-31-6-61.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/f70bf0c5536c6dee5aa108138d854523e419526052aa0a454ce8a6ef6e6dd998/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-5-139.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=34822d54df2d01e9097c31700b33e7679f4dff4de5e0ef01a56b6c12e183a400
+ ssh -q ip-172-31-5-139.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/34822d54df2d01e9097c31700b33e7679f4dff4de5e0ef01a56b6c12e183a400/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-1-237.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=7aa188c6a47e1a787b9ac443b4954268fb2c110d73461e1c0c1d4152a3ee7713
+ echo 4096
+ ssh -q ip-172-31-1-237.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/7aa188c6a47e1a787b9ac443b4954268fb2c110d73461e1c0c1d4152a3ee7713/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-28.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=bdf73b304ebadeffe703d204a8f4a5ad2fa65a6a1e7d2d23ff30bac20da7d3d8
+ ssh -q ip-172-31-4-28.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/bdf73b304ebadeffe703d204a8f4a5ad2fa65a6a1e7d2d23ff30bac20da7d3d8/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-4-107.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=1cc930c2ca0cc8edb8fdc0974fc41b5e737032e79f75185a27fbef103feb2223
+ echo 4096
+ ssh -q ip-172-31-4-107.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/1cc930c2ca0cc8edb8fdc0974fc41b5e737032e79f75185a27fbef103feb2223/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-0-93.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=8fd7693483b86b90dd77aa4483596da1135e8472f0f099359223774ea3a3d4c6
+ echo 4096
+ ssh -q ip-172-31-0-93.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/8fd7693483b86b90dd77aa4483596da1135e8472f0f099359223774ea3a3d4c6/cpu.shares
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-13-183.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=3b95a3c16f0ff4b3842069dc07b73fe3d77d87e17978ea905f35f5ce76c2537b
+ ssh -q ip-172-31-13-183.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/3b95a3c16f0ff4b3842069dc07b73fe3d77d87e17978ea905f35f5ce76c2537b/cpu.shares
+ echo 4096
4096
+ for HOST in $ALL_ENGINE_HOSTS
++ /home/ubuntu/boki-benchmarks/scripts/exp_helper get-container-id --base-dir=/home/ubuntu/boki-benchmarks/experiments/logsize/optimal --service boki-engine --machine-host ip-172-31-15-45.ap-southeast-1.compute.internal
+ ENGINE_CONTAINER_ID=8e4ffb3681915e90bbc296d0df06182cff7593433848be0df84f8e6ba84c27a1
+ ssh -q ip-172-31-15-45.ap-southeast-1.compute.internal -- sudo tee /sys/fs/cgroup/cpu,cpuacct/docker/8e4ffb3681915e90bbc296d0df06182cff7593433848be0df84f8e6ba84c27a1/cpu.shares
+ echo 4096
4096
+ sleep 10
+ rm -rf /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_write
+ mkdir -p /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_write
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- cat /proc/cmdline
+ ssh -q ip-172-31-11-118.ap-southeast-1.compute.internal -- uname -a
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/workload.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ scp -q /home/ubuntu/boki-benchmarks/workloads/workflow/optimal/benchmark/rw/prewarm.lua ip-172-31-12-251.ap-southeast-1.compute.internal:/tmp
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 120 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- /usr/local/bin/wrk -t 2 -c 2 -d 600 -L -U -s /tmp/workload.lua http://ip-172-31-11-118.ap-southeast-1.compute.internal:8080 -R 300
+ sleep 10
+ scp -q ip-172-31-11-118.ap-southeast-1.compute.internal:/mnt/inmem/store/async_results /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_write
+ /home/ubuntu/boki-benchmarks/scripts/compute_latency.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_write/async_results
+ /home/ubuntu/boki-benchmarks/scripts/compute_logsize.py --async-result-file /home/ubuntu/boki-benchmarks/experiments/logsize/optimal/results/ReadRatio0.9_QPS300_write/async_results --num-keys 10000 --value-size 256
+ ssh -q ip-172-31-12-251.ap-southeast-1.compute.internal -- TABLE_PREFIX=sAwR3nvj- AWS_REGION=ap-southeast-1 LoggingMode=write NUM_KEYS=10000 VALUE_SIZE=256 /tmp/rw/init clean
2023/04/06 03:02:11 [INFO] log mode: WRITELOG
finished ReadRatio0.9_QPS300_write
